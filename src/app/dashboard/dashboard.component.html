<ion-content class="bg-white text-black">
  <!-- Dashboard View -->
  <div *ngIf="currentView === 'dashboard'" class="p-4 h-full bg-white">
    <!-- Header -->
    <div class="flex items-center justify-between mb-6 pt-8">
      <button (click)="goToSettings()" class="flex items-center">
        <div class="w-12 h-12 bg-black rounded-full flex items-center justify-center mr-3">
          <ion-icon name="person" class="text-white text-lg"></ion-icon>
        </div>
        <div>
          <p class="text-black text-sm font-medium">Welcome back</p>
          <p class="text-black font-semibold text-base">{{ user.name }}</p>
        </div>
      </button>
      <div class="w-10 h-10 bg-black rounded-full flex items-center justify-center">
        <ion-icon name="notifications" class="text-white text-lg"></ion-icon>
      </div>
    </div>

    <!-- Progress Steps -->
    <div class="flex items-center justify-center mb-8">
      <div class="flex items-center">
        <!-- Step 1 -->
        <div class="flex flex-col items-center">
          <div class="w-8 h-8 bg-black rounded-full flex items-center justify-center relative">
            <ion-icon name="checkmark" class="text-white text-sm"></ion-icon>
          </div>
        </div>
        
        <!-- Line 1 -->
        <div class="w-16 h-0.5 bg-gray-300 mx-2"></div>
        
        <!-- Step 2 - KYC (Active) -->
        <div class="flex flex-col items-center">
          <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center relative">
            <span class="text-white text-sm font-bold">2</span>
          </div>
          <p class="text-blue-500 text-sm font-medium mt-2">KYC</p>
        </div>
        
        <!-- Line 2 -->
        <div class="w-16 h-0.5 bg-gray-300 mx-2"></div>
        
        <!-- Step 3 -->
        <div class="flex flex-col items-center">
          <div class="w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center relative">
            <span class="text-gray-500 text-sm font-bold">3</span>
          </div>
          <p class="text-gray-500 text-sm font-medium mt-2">Deposit</p>
        </div>
      </div>
    </div>

    <!-- Total Value Section -->
    <div class="mb-6">
      <div class="flex items-center justify-between mb-4">
        <div class="flex items-center">
          <p class="text-black text-base font-medium mr-2">EST. Total Value (USD)</p>
          <button (click)="toggleDashboardAmount()" class="text-black">
            <ion-icon [name]="getEyeIcon(dashboardAmountVisible)" class="text-lg"></ion-icon>
          </button>
        </div>
        <button (click)="addFunds()" class="bg-blue-500 text-white px-6 py-2 rounded-lg font-medium text-sm">
          Add Funds
        </button>
      </div>
      <p class="text-black text-4xl font-bold mb-6">{{ getDisplayAmount(user.totalValue, dashboardAmountVisible) }}</p>
    </div>

    <!-- Crypto Section -->
    <div>
      <h3 class="text-black text-xl font-semibold mb-6">Crypto</h3>
      <div class="space-y-0">
        <div *ngFor="let crypto of cryptoHoldings; let i = index" 
             class="flex items-center justify-between py-4"
             [class.border-b]="i < cryptoHoldings.length - 1"
             [class.border-gray-200]="i < cryptoHoldings.length - 1">
          
          <div class="flex items-center flex-1">
            <!-- Radio Button -->
            <div class="w-5 h-5 border-2 border-gray-300 rounded-full mr-4 flex items-center justify-center">
              <div class="w-2 h-2 bg-transparent rounded-full"></div>
            </div>
            
            <div class="flex-1">
              <div class="flex justify-between items-start">
                <div>
                  <p class="text-black font-semibold text-base">{{ crypto.name }}</p>
                  <p class="text-gray-600 text-sm">{{ crypto.fullName }}</p>
                  <p class="text-gray-600 text-sm">{{ crypto.pnl }}</p>
                </div>
                
                <div class="text-right">
                  <p class="text-black font-semibold text-base">{{ crypto.amount }}</p>
                  <p class="text-gray-600 text-sm">{{ crypto.value }}</p>
                  <p class="text-red-500 text-sm">{{ crypto.change }}</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Account Balance View -->
  <div *ngIf="currentView === 'account-balance'" class="p-4 h-full bg-white">
    <!-- Header -->
    <div class="flex items-center mb-8 pt-8">
      <button (click)="goBack()" class="mr-4">
        <ion-icon name="chevron-back-outline" class="text-black text-2xl"></ion-icon>
      </button>
      <h1 class="text-black text-xl font-semibold">Account Balance</h1>
    </div>

    <!-- Total Value Section -->
    <div class="mb-8">
      <div class="flex items-center mb-4">
        <p class="text-black text-base mr-2">EST. Total Value (USD)</p>
        <button (click)="togglePortfolioAmount()" class="text-black">
          <ion-icon [name]="getEyeIcon(portfolioAmountVisible)" class="text-xl"></ion-icon>
        </button>
      </div>
      <p class="text-black text-5xl font-bold mb-8">{{ getDisplayAmount(user.totalValue, portfolioAmountVisible) }}</p>
    
      <!-- Action Buttons -->
      <div class="flex space-x-4 mb-8">
        <button (click)="goToConvert()" class="flex items-center justify-center bg-transparent border border-gray-400 text-black py-3 px-6 rounded-full font-medium">
          <ion-icon name="swap-horizontal-outline" class="mr-2 text-lg"></ion-icon>
          Convert
        </button>
        <button class="flex items-center justify-center bg-transparent border border-gray-400 text-black py-3 px-6 rounded-full font-medium">
          <ion-icon name="arrow-up-outline" class="mr-2 text-lg"></ion-icon>
          Send
        </button>
        <button class="flex items-center justify-center bg-transparent border border-gray-400 text-black py-3 px-6 rounded-full font-medium">
          <ion-icon name="arrow-down-outline" class="mr-2 text-lg"></ion-icon>
          Receive
        </button>
      </div>
    </div>

    <!-- Separator Line -->
    <div class="border-t border-gray-300 mb-6"></div>

    <!-- Crypto Holdings -->
    <div>
      <h3 class="text-black text-xl font-semibold mb-6">Crypto</h3>
      <div class="space-y-0">
        <div *ngFor="let crypto of accountCrypto; let i = index" 
           class="flex items-center justify-between py-4"
           [class.border-b]="i < accountCrypto.length - 1"
           [class.border-gray-300]="i < accountCrypto.length - 1">
        
          <div class="flex items-center flex-1">
            <!-- Radio Button -->
            <div class="w-5 h-5 border-2 border-gray-400 rounded-full mr-4 flex items-center justify-center">
              <div class="w-2 h-2 bg-transparent rounded-full"></div>
            </div>
            
            <div class="flex-1">
              <div class="flex justify-between items-start">
                <div>
                  <p class="text-black font-semibold text-lg">{{ crypto.name }}</p>
                  <p class="text-gray-600 text-base">{{ crypto.symbol }}</p>
                  <p *ngIf="crypto.pnl" class="text-gray-600 text-base">{{ crypto.pnl }}</p>
                </div>
                
                <div class="text-right">
                  <p *ngIf="crypto.amount" class="text-black font-semibold text-lg">{{ crypto.amount }}</p>
                  <p class="text-gray-600 text-base">{{ crypto.value }}</p>
                  <p *ngIf="crypto.change" [ngClass]="crypto.changeColor" class="text-base">{{ crypto.change }}</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Convert View -->
  <div *ngIf="currentView === 'convert'" class="p-4 h-full bg-white">
    <!-- Header -->
    <div class="flex items-center mb-6 pt-8">
      <button (click)="goBack()" class="mr-4">
        <ion-icon name="chevron-back-outline" class="text-black text-xl"></ion-icon>
      </button>
    </div>

    <!-- Account Section -->
    <div class="mb-6">
      <p class="text-black text-lg font-semibold mb-4">Account</p>
    
    <!-- From Section with Blue Border -->
    <div class="border-2 rounded-xl p-4 mb-4 bg-white" 
         [class.border-blue-500]="activeInputField === 'from'"
         [class.border-gray-300]="activeInputField !== 'from'">
      <div class="flex justify-between items-center mb-2">
        <span class="text-gray-600 text-sm">From</span>
        <div class="flex items-center">
          <span class="text-gray-600 text-sm">Available Balance: {{ getAvailableBalance(convertFrom) }}</span>
          <div class="w-4 h-4 bg-blue-500 rounded-full ml-2 flex items-center justify-center">
            <span class="text-white text-xs">i</span>
          </div>
        </div>
      </div>
      <div class="flex items-center justify-between">
        <div class="flex items-center">
          <div>
            <p class="text-black font-bold text-lg">{{ convertFrom }}</p>
            <p class="text-gray-600 text-sm">Bitcoin</p>
          </div>
        </div>
        <div class="text-right flex items-center">
          <button (click)="setActiveInputField('from')" class="text-right">
            <span class="text-black text-lg font-medium" 
                  [class.text-blue-500]="activeInputField === 'from'">
              {{ convertFromAmount || '0' }}
            </span>
          </button>
          <button (click)="setMaxAmount()" class="text-blue-500 text-sm ml-2 cursor-pointer hover:text-blue-700">
            Max
          </button>
        </div>
      </div>
    </div>

    <!-- Convert Icon -->
    <div class="flex justify-center mb-4">
      <div class="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center">
        <ion-icon name="swap-vertical-outline" class="text-white"></ion-icon>
      </div>
    </div>

    <!-- To Section -->
    <div class="border-2 rounded-xl p-4 mb-6 bg-white"
         [class.border-blue-500]="activeInputField === 'to'"
         [class.border-gray-300]="activeInputField !== 'to'">
      <div class="flex justify-between items-center mb-2">
        <span class="text-gray-600 text-sm">To</span>
      </div>
      <div class="flex items-center justify-between">
        <div class="flex items-center">
          <div>
            <p class="text-black font-bold text-lg">{{ convertTo }}</p>
          </div>
        </div>
        <button (click)="setActiveInputField('to')" class="text-right">
          <span class="text-black text-lg font-medium"
                [class.text-blue-500]="activeInputField === 'to'">
            {{ convertToAmount || '---' }}
          </span>
        </button>
      </div>
    </div>

    <!-- Convert Rate -->
    <div class="text-center mb-6">
      <p class="text-gray-600 text-sm">1BTC ≈ -- USDT</p>
    </div>

    <!-- Convert Button -->
    <button (click)="convert()" class="w-full bg-blue-600 text-white py-4 rounded-xl font-medium mb-6">
      Convert
    </button>
  </div>

  <!-- Keypad -->
  <div class="grid grid-cols-3 gap-3">
    <!-- Row 1 -->
    <button (click)="appendToConvertAmount('1')" class="h-16 bg-gray-200 rounded-xl text-black text-xl font-medium flex flex-col items-center justify-center">
      <span class="text-2xl">1</span>
    </button>
    <button (click)="appendToConvertAmount('2')" class="h-16 bg-gray-200 rounded-xl text-black text-xl font-medium flex flex-col items-center justify-center">
      <span class="text-2xl">2</span>
      <span class="text-xs text-gray-500">ABC</span>
    </button>
    <button (click)="appendToConvertAmount('3')" class="h-16 bg-gray-200 rounded-xl text-black text-xl font-medium flex flex-col items-center justify-center">
      <span class="text-2xl">3</span>
      <span class="text-xs text-gray-500">DEF</span>
    </button>
    
    <!-- Row 2 -->
    <button (click)="appendToConvertAmount('4')" class="h-16 bg-gray-200 rounded-xl text-black text-xl font-medium flex flex-col items-center justify-center">
      <span class="text-2xl">4</span>
      <span class="text-xs text-gray-500">GHI</span>
    </button>
    <button (click)="appendToConvertAmount('5')" class="h-16 bg-gray-200 rounded-xl text-black text-xl font-medium flex flex-col items-center justify-center">
      <span class="text-2xl">5</span>
      <span class="text-xs text-gray-500">JKL</span>
    </button>
    <button (click)="appendToConvertAmount('6')" class="h-16 bg-gray-200 rounded-xl text-black text-xl font-medium flex flex-col items-center justify-center">
      <span class="text-2xl">6</span>
      <span class="text-xs text-gray-500">MNO</span>
    </button>
    
    <!-- Row 3 -->
    <button (click)="appendToConvertAmount('7')" class="h-16 bg-gray-200 rounded-xl text-black text-xl font-medium flex flex-col items-center justify-center">
      <span class="text-2xl">7</span>
      <span class="text-xs text-gray-500">PQRS</span>
    </button>
    <button (click)="appendToConvertAmount('8')" class="h-16 bg-gray-200 rounded-xl text-black text-xl font-medium flex flex-col items-center justify-center">
      <span class="text-2xl">8</span>
      <span class="text-xs text-gray-500">TUV</span>
    </button>
    <button (click)="appendToConvertAmount('9')" class="h-16 bg-gray-200 rounded-xl text-black text-xl font-medium flex flex-col items-center justify-center">
      <span class="text-2xl">9</span>
      <span class="text-xs text-gray-500">WXYZ</span>
    </button>
    
    <!-- Row 4 -->
    <div></div>
    <button (click)="appendToConvertAmount('0')" class="h-16 bg-gray-200 rounded-xl text-black text-xl font-medium flex flex-col items-center justify-center">
      <span class="text-2xl">0</span>
    </button>
    <button (click)="appendToConvertAmount('.')" class="h-16 bg-gray-200 rounded-xl text-black text-xl font-medium flex items-center justify-center">
      <span class="text-2xl">.</span>
    </button>
  </div>
</div>

  <!-- Buy/Sell Trading View -->
  <div *ngIf="currentView === 'buy-sell'" class="p-4 h-full bg-white relative">
    <!-- Header -->
    <div class="flex items-center justify-between mb-6 pt-8">
      <button (click)="goBack()" class="mr-4">
        <ion-icon name="chevron-back-outline" class="text-black text-2xl"></ion-icon>
      </button>
      <h1 class="text-black text-2xl font-bold">{{ tradingMode }}</h1>
      <div></div>
    </div>

    <!-- Trading Pair -->
    <div class="flex items-center mb-2">
      <h2 class="text-black text-3xl font-bold mr-2">{{ tradingPair }}</h2>
      <ion-icon name="chevron-down-outline" class="text-black text-xl"></ion-icon>
    </div>
    
    <!-- Percentage Change -->
    <p class="text-green-500 font-bold text-lg mb-6">{{ tradingPercentChange }}</p>

    <!-- Main Layout with Order Book on Right -->
    <div class="flex">
      <!-- Left Column - Trading Controls -->
      <div class="flex-1 pr-4">
        <!-- Buy/Sell Toggle -->
        <div class="flex bg-gray-100 rounded-2xl mb-4 p-1">
          <button (click)="setTradingMode('BUY')" 
                  [class]="tradingMode === 'BUY' ? 'bg-green-500 text-white' : 'bg-transparent text-black'"
                  class="flex-1 py-3 rounded-xl font-bold text-lg transition-colors">
            BUY
          </button>
          <button (click)="setTradingMode('SELL')" 
                  [class]="tradingMode === 'SELL' ? 'bg-red-500 text-white' : 'bg-transparent text-black'"
                  class="flex-1 py-3 rounded-xl font-bold text-lg transition-colors">
            SELL
          </button>
        </div>

        <!-- Order Type Selector -->
        <div class="mb-4 border-2 border-gray-300 rounded-2xl p-4 flex items-center justify-between">
          <div class="flex items-center">
            <div class="w-6 h-6 bg-black rounded-full flex items-center justify-center mr-3">
              <span class="text-white text-xs font-bold">i</span>
            </div>
            <span class="text-black text-lg font-medium">{{ orderType }}</span>
          </div>
          <ion-icon name="chevron-down-outline" class="text-gray-600 text-xl"></ion-icon>
        </div>

        <!-- Price Input -->
        <div class="mb-4 border-2 border-gray-300 rounded-2xl p-4">
          <div class="flex items-center justify-between">
            <button (click)="decreasePrice()" class="text-gray-600 text-3xl font-bold w-8 h-8 flex items-center justify-center">−</button>
            <div class="flex-1 text-center">
              <p class="text-gray-600 text-sm mb-1">Price (USDT)</p>
              <p class="text-black text-2xl font-bold">{{ tradingPrice }}</p>
            </div>
            <button (click)="increasePrice()" class="text-gray-600 text-3xl font-bold w-8 h-8 flex items-center justify-center">+</button>
          </div>
        </div>

        <!-- Amount Input -->
        <div class="mb-4 border-2 border-gray-300 rounded-2xl p-4">
          <div class="flex items-center justify-between">
            <button (click)="decreaseAmount()" class="text-gray-600 text-3xl font-bold w-8 h-8 flex items-center justify-center">−</button>
            <div class="flex-1 text-center">
              <p class="text-gray-600 text-sm mb-1">Amount (KAITO)</p>
              <p class="text-black text-2xl font-bold">{{ tradingData.amount || '---' }}</p>
            </div>
            <button (click)="increaseAmount()" class="text-gray-600 text-3xl font-bold w-8 h-8 flex items-center justify-center">+</button>
          </div>
        </div>

        <!-- Total -->
        <div class="mb-6 border-2 border-gray-300 rounded-2xl p-4">
          <div class="flex justify-between items-center">
            <span class="text-gray-600 text-lg font-medium">Total(USDT)</span>
          </div>
        </div>

        <!-- Trading Info -->
        <div class="space-y-3 mb-6">
          <div class="flex justify-between items-center">
            <span class="text-gray-600 text-lg">Avbl</span>
            <div class="flex items-center">
              <span class="text-black text-lg">{{ tradingData.availableBalance }}</span>
              <div class="w-5 h-5 bg-blue-500 rounded-full ml-2 flex items-center justify-center">
                <span class="text-white text-xs">+</span>
              </div>
            </div>
          </div>
          <div class="flex justify-between">
            <span class="text-gray-600 text-lg">Max Buy</span>
            <span class="text-black text-lg">{{ tradingData.maxBuy }}</span>
          </div>
          <div class="flex justify-between">
            <span class="text-gray-600 text-lg">Est. Fee</span>
            <span class="text-black text-lg">{{ tradingData.estFee }}</span>
          </div>
        </div>
      </div>

      <!-- Right Column - Order Book -->
      <div class="w-32 flex flex-col">
        <!-- Order Book Headers -->
        <div class="grid grid-cols-2 gap-1 mb-2">
          <p class="text-gray-600 text-center text-xs font-medium">Price<br>(USDT)</p>
          <p class="text-gray-600 text-center text-xs font-medium">Amount<br>(KAITO)</p>
        </div>
        
        <!-- Red (Sell) Orders -->
        <div class="space-y-1 mb-2">
          <div *ngFor="let order of orderBookData.slice(0, 7)" class="grid grid-cols-2 gap-1">
            <div class="text-red-500 text-right text-xs font-medium">{{ order.price }}</div>
            <div class="text-black text-left text-xs">{{ order.amount }}</div>
          </div>
        </div>

        <!-- Large Total Display -->
        <div class="text-center my-4">
          <p class="text-red-500 text-2xl font-bold">{{ tradingData.total }}</p>
          <p class="text-gray-500 text-sm">₹ $2.03</p>
        </div>

        <!-- Green (Buy) Orders -->
        <div class="space-y-1">
          <div *ngFor="let order of orderBookData.slice(0, 7)" class="grid grid-cols-2 gap-1">
            <div class="text-green-500 text-right text-xs font-medium">{{ order.price }}</div>
            <div class="text-black text-left text-xs">{{ order.amount }}</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Action Button - positioned at bottom -->
    <div class="fixed bottom-20 left-4 right-4">
      <button (click)="executeTrade()" 
              [class]="tradingMode === 'BUY' ? 'bg-blue-500 text-white' : 'bg-red-500 text-white'"
              class="w-full py-4 rounded-2xl font-bold text-xl">
        {{ tradingMode === 'BUY' ? 'Buy KAITO' : 'Sell KAITO' }}
      </button>
    </div>
  </div>

  <!-- Bottom Navigation -->
  <div class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 px-4 py-2">
    <div class="flex justify-around">
      <button (click)="navigateToHome()" class="flex flex-col items-center py-2">
        <ion-icon name="home" [class]="currentView === 'dashboard' ? 'text-blue-500' : 'text-gray-600'" class="text-xl mb-1"></ion-icon>
        <span [class]="currentView === 'dashboard' ? 'text-blue-500' : 'text-gray-600'" class="text-xs">Home</span>
      </button>
      <button (click)="navigateToInvestment()" class="flex flex-col items-center py-2">
        <ion-icon name="trending-up" [class]="currentView === 'buy-sell' ? 'text-blue-500' : 'text-gray-600'" class="text-xl mb-1"></ion-icon>
        <span [class]="currentView === 'buy-sell' ? 'text-blue-500' : 'text-gray-600'" class="text-xs">Investment</span>
      </button>
      <button (click)="navigateToDonate()" class="flex flex-col items-center py-2">
        <ion-icon name="heart" class="text-gray-600 text-xl mb-1"></ion-icon>
        <span class="text-gray-600 text-xs">Donate</span>
      </button>
      <button (click)="navigateToProfile()" class="flex flex-col items-center py-2">
        <ion-icon name="person" class="text-gray-600 text-xl mb-1"></ion-icon>
        <span class="text-gray-600 text-xs">Profile</span>
      </button>
    </div>
  </div>
</ion-content>
